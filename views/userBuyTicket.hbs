<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=100, initial-scale=1">
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <script>
      Handlebars.registerHelper('dateTime1',function(datetime){
        return moment(datetime).format('DD-MM-YYYY @  hh:mm');
      });

    </script>
  <style>
    .btn{
      position: absolute;
      left:50%;
      width: 100px;
      height: 30px;;
      color:blue;
    }
    #back{
        position: absolute;
        top:10px;
        right: 30px;
        width: 140px;
        height: 60px;
    }
    table{
        margin: 30px;
        margin-top: 10px;
    }
      
    table th{
        color:#E7A1B0;
        background-color: black;
      
    }
    @media screen and (max-width: 1000px) {
      .topnav a:not(:first-child) {display: none;}
      .topnav a.icon {
      float: right;
      display: block;
    }
    }

/* The "responsive" class is added to the topnav with JavaScript when the user clicks on the icon. This class makes the topnav look good on small screens (display the links vertically instead of horizontally) */
    @media screen and (max-width: 1000px) {
      .topnav.responsive {position: relative;}
      .topnav.responsive a.icon {
      position: absolute;
      right: 0;
      top: 0;
    }
    .topnav.responsive a {
      float: none;
      display: block;
      text-align: left;
    }
    }
    .slides{
    margin-top:10px;
    margin-left:100px;
    }
    a:hover{
      text-decoration: none;
    }
    .slides1{
      margin-top:10px;
      margin-left:100px;
    }
    a{
      text-transform: uppercase;
    }
    .container{
      position: absolute;
      left:50%;
    }
    .container table,th,tr{
      margin-bottom:100px;
      position: absolute;
      left:30%;
      top:10%;
      height: auto;
    }
    }
    h1, h2{
      text-align: center;
      color: blue;

    }
    .topnav {
      overflow: hidden;
      background-color: #333;
    }

    .topnav a {
      float: left;
      color: #f2f2f2;
      text-align: center;
      padding: 14px 16px;
      text-decoration: none;
      font-size: 17px;
    }

    .topnav a:hover {
      background-color: #ddd;
      color: black;
    }

    .topnav a.active {
      background-color: #4CAF50;
      color: white;
    }

    .topnav-right {
      float: right;
    }
  </style>
 
  </head>

<body>
  <div class="topnav">
    <a class="active" href="#home"><i>WELCOME {{username}} FOR EVENT MANAGEMENT SYSTEM </i></a>
    <div class="topnav-right">
      <a href="bookingToviewMore?image={{image}}&likes={{likes}}&username={{username}}&eventId={{eventId}}&eventName={{eventName}}&description={{description}}&maxNoOfTicket={{maxNoOfTicket}}
      &bookingStartTime={{bookingStartTime}}&bookingEndTime={{bookingEndTime}}&cost={{cost}}'">PREVIOUS</a>
      <a href="/">LOGOUT</a>
    </div>
  </div>

  <table class="table table-hover">    
    <div class="container">
      <div class="row justify-content-center">
        <table>
          <tr>   
            <td>
              <div class='col-md-4'>
                <h3  style="text-align: center,color:red;" name="eventname"><strong>{{eventName}}</strong></h3>
                  <div class='card shadow' style='width: 40rem;'>
                    <div class='inner'>
                      <img src="{{image}}" class='card-img-top' >  
                    </div>
                    <div class='card-body text-center'>
                      <h2 class='card-title' name ="description">{{description}}</h2>
                      <p class='card-text'name="tickets" id="tickets">Available tickets: {{maxNoOfTicket}}</p>
                      <p class="card-text" name="bookingEndTime">Booking Ends in :{{dateTime1 bookingEndTime}}</p>
                      <h2 class='card-text'>COST:{{cost}}</h2>
                      <p>NO of ticket:<input type="number" name="bookedTicket" class="bookedTicket" id="bookedTicket"placeholder="Enter no of ticket you want to book"/></p>
                      <button id="btn"class="card-text" style="color: blue;width:50px;height:30px;">BUY</button>
                    </div>
                  </div>
              </div>
            </td>
        </table>
      </div>
    </div>

  <script>
    $(document).ready(() => {
      $('#btn').click(()=>{
      let maxTicket = {{maxNoOfTicket}};
      let newAvailable = maxTicket-$('#bookedTicket').val();
      $.ajax({
        url:"/bookedTicket?description={{description}}&image={{image}}&ticket={{maxNoOfTicket}}&username={{username}}&eventName={{eventName}}&bookingStartTime={{bookingStartTime}}&bookingEndTime={{bookingEndTime}}&cost={{cost}}",
        method:"POST",
        dataType:"text",
        data:{
          number:$('#bookedTicket').val()
        },
        success:function(response){
          $('#bookedTicket').val(" ");
          let data = JSON.parse(response);
          if(data[0].message ==="ticket booked successfuly!!.."){
            $('#tickets').text("Available tickets: "+newAvailable);

          }
          alert(data[0].message);

        }
      })          
    });
  });
        
  </script>
</body> 
</html> 

